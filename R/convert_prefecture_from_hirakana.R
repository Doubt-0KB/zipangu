#' Convert prefecture names from hiragana and katakana
#'
#' @param x prefecture name in hiragana or katakana
#'
#' @importFrom stringr str_c
#' @importFrom stringr str_detect
#'
#' @examples
#' convert_prefecture_from_hirakana(c("\u3068\u3046\u304d\u3087\u3046\u3068"))
#' convert_prefecture_from_hirakana(c("\u30c8\u30a6\u30ad\u30e7\u30a6\u30c8", "\u30ad\u30e7\u30a6\u30c8"))
#' convert_prefecture_from_hirakana(c("\u30c8\u30a6\u30ad\u30e7\u30a6", "\u304a\u304a\u3055\u304b"))
#'
#' @export
#'
convert_prefecture_from_hirakana <- function(x){
  x <- enc2utf8(as.character(x)) #Encoding to UTF-8

  x <- str_conv_hirakana(x, to="hiragana") #Convert to hiragana
  x <- str_c("^", x) #Avoid conflicts between "\u304d\u3087\u3046\u3068" and "\u3068\u3046\u304d\u3087\u3046\u3068"
  y <- c("\u307b\u3063\u304b\u3044\u3069\u3046","\u3042\u304a\u3082\u308a\u3051\u3093","\u3044\u308f\u3066\u3051\u3093",
         "\u307f\u3084\u304e\u3051\u3093","\u3042\u304d\u305f\u3051\u3093","\u3084\u307e\u304c\u305f\u3051\u3093",
         "\u3075\u304f\u3057\u307e\u3051\u3093","\u3044\u3070\u3089\u304d\u3051\u3093","\u3068\u3061\u304e\u3051\u3093",
         "\u3050\u3093\u307e\u3051\u3093","\u3055\u3044\u305f\u307e\u3051\u3093","\u3061\u3070\u3051\u3093",
         "\u3068\u3046\u304d\u3087\u3046\u3068","\u304b\u306a\u304c\u308f\u3051\u3093","\u306b\u3044\u304c\u305f\u3051\u3093",
         "\u3068\u3084\u307e\u3051\u3093","\u3044\u3057\u304b\u308f\u3051\u3093","\u3075\u304f\u3044\u3051\u3093",
         "\u3084\u307e\u306a\u3057\u3051\u3093","\u306a\u304c\u306e\u3051\u3093","\u304e\u3075\u3051\u3093",
         "\u3057\u305a\u304a\u304b\u3051\u3093","\u3042\u3044\u3061\u3051\u3093","\u307f\u3048\u3051\u3093",
         "\u3057\u304c\u3051\u3093","\u304d\u3087\u3046\u3068\u3075","\u304a\u304a\u3055\u304b\u3075",
         "\u3072\u3087\u3046\u3054\u3051\u3093","\u306a\u3089\u3051\u3093","\u308f\u304b\u3084\u307e\u3051\u3093",
         "\u3068\u3063\u3068\u308a\u3051\u3093","\u3057\u307e\u306d\u3051\u3093","\u304a\u304b\u3084\u307e\u3051\u3093",
         "\u3072\u308d\u3057\u307e\u3051\u3093","\u3084\u307e\u3050\u3061\u3051\u3093","\u3068\u304f\u3057\u307e\u3051\u3093",
         "\u304b\u304c\u308f\u3051\u3093","\u3048\u3072\u3081\u3051\u3093","\u3053\u3046\u3061\u3051\u3093",
         "\u3075\u304f\u304a\u304b\u3051\u3093","\u3055\u304c\u3051\u3093","\u306a\u304c\u3055\u304d\u3051\u3093",
         "\u304f\u307e\u3082\u3068\u3051\u3093","\u304a\u304a\u3044\u305f\u3051\u3093","\u307f\u3084\u3056\u304d\u3051\u3093",
         "\u304b\u3054\u3057\u307e\u3051\u3093","\u304a\u304d\u306a\u308f\u3051\u3093","\u305c\u3093\u3053\u304f")
  z <- c("\u5317\u6d77\u9053","\u9752\u68ee\u770c","\u5ca9\u624b\u770c",
         "\u5bae\u57ce\u770c","\u79cb\u7530\u770c","\u5c71\u5f62\u770c",
         "\u798f\u5cf6\u770c","\u8328\u57ce\u770c","\u6803\u6728\u770c",
         "\u7fa4\u99ac\u770c","\u57fc\u7389\u770c","\u5343\u8449\u770c",
         "\u6771\u4eac\u90fd","\u795e\u5948\u5ddd\u770c","\u65b0\u6f5f\u770c",
         "\u5bcc\u5c71\u770c","\u77f3\u5ddd\u770c","\u798f\u4e95\u770c",
         "\u5c71\u68a8\u770c","\u9577\u91ce\u770c","\u5c90\u961c\u770c",
         "\u9759\u5ca1\u770c","\u611b\u77e5\u770c","\u4e09\u91cd\u770c",
         "\u6ecb\u8cc0\u770c","\u4eac\u90fd\u5e9c","\u5927\u962a\u5e9c",
         "\u5175\u5eab\u770c","\u5948\u826f\u770c","\u548c\u6b4c\u5c71\u770c",
         "\u9ce5\u53d6\u770c","\u5cf6\u6839\u770c","\u5ca1\u5c71\u770c",
         "\u5e83\u5cf6\u770c","\u5c71\u53e3\u770c","\u5fb3\u5cf6\u770c",
         "\u9999\u5ddd\u770c","\u611b\u5a9b\u770c","\u9ad8\u77e5\u770c",
         "\u798f\u5ca1\u770c","\u4f50\u8cc0\u770c","\u9577\u5d0e\u770c",
         "\u718a\u672c\u770c","\u5927\u5206\u770c","\u5bae\u5d0e\u770c",
         "\u9e7f\u5150\u5cf6\u770c","\u6c96\u7e04\u770c","\u5168\u56fd") #Prefecture(long)
  w <- c("\u5317\u6d77\u9053","\u9752\u68ee","\u5ca9\u624b",
         "\u5bae\u57ce","\u79cb\u7530","\u5c71\u5f62",
         "\u798f\u5cf6","\u8328\u57ce","\u6803\u6728",
         "\u7fa4\u99ac","\u57fc\u7389","\u5343\u8449",
         "\u6771\u4eac","\u795e\u5948\u5ddd","\u65b0\u6f5f",
         "\u5bcc\u5c71","\u77f3\u5ddd","\u798f\u4e95",
         "\u5c71\u68a8","\u9577\u91ce","\u5c90\u961c",
         "\u9759\u5ca1","\u611b\u77e5","\u4e09\u91cd",
         "\u6ecb\u8cc0","\u4eac\u90fd","\u5927\u962a",
         "\u5175\u5eab","\u5948\u826f","\u548c\u6b4c\u5c71",
         "\u9ce5\u53d6","\u5cf6\u6839","\u5ca1\u5c71",
         "\u5e83\u5cf6","\u5c71\u53e3","\u5fb3\u5cf6",
         "\u9999\u5ddd","\u611b\u5a9b","\u9ad8\u77e5",
         "\u798f\u5ca1","\u4f50\u8cc0","\u9577\u5d0e",
         "\u718a\u672c","\u5927\u5206","\u5bae\u5d0e",
         "\u9e7f\u5150\u5cf6","\u6c96\u7e04","\u5168\u56fd") #Prefecture(short)

  for(i in 1:length(x)){
    if(!any(str_detect(y, x[i])))
      stop("\u5b58\u5728\u3057\u306a\u3044\u5730\u57df\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059") #check;is Japan
    x[i] <- ifelse(any(str_detect(x, y)),
                   z[str_detect(y, x[i])], #Convert romen to japanese (long)
                   w[str_detect(y, x[i])]) #Convert romen to japanese (short)
  }

  return(x)
}
